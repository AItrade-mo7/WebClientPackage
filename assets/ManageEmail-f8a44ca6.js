import{d as L,r as f,m as $,c as _,b as e,w as t,u as y,e as i,t as g,F as k,aF as O,bJ as z,o as m,f as d,aH as U,g as h,a as C,bK as R,y as w,bL as W,bM as G,h as j,_ as P,j as H}from"./index-95e0417b.js";import{v as M}from"./verify-fcd68c05.js";import{A}from"./index-571b3aeb.js";import{_ as J}from"./Avatar-795eae64.js";import{_ as K,a as X}from"./FormItem-16ee8613.js";import{_ as q}from"./Input-b78db60b.js";import{_ as Q}from"./InputGroup-c060b251.js";import"./Tag-5dcaf9b3.js";import"./format-length-c9d165c6.js";import"./get-82e41413.js";import"./Suffix-ac62c6bb.js";import"./use-merged-state-2a0ec557.js";const Y={class:"PageWrapper ManageEmail"},Z={className:"Personal__info"},aa={className:"Personal__NickName"},ea={className:"Personal__Email"},oa={class:"EmailWrapper"},la={class:"Email"},sa={key:0,class:"MainTxt"},ta={key:1,class:"Btn"},na={class:"AddWrapper"},ia=L({__name:"ManageEmail",setup(_a){const b=C(()=>P(()=>import("./PageTitle-b89e7a26.js"),["assets/PageTitle-b89e7a26.js","assets/index-95e0417b.js","assets/index-0be103ef.css","assets/PageTitle-0e701932.css"])),N=C(()=>P(()=>import("./XIcon-bc7fc57b.js"),["assets/XIcon-bc7fc57b.js","assets/index-95e0417b.js","assets/index-0be103ef.css","assets/XIcon-dcf3bf82.css"])),x=C(()=>P(()=>import("./SendCode-a5ea60b6.js"),["assets/SendCode-a5ea60b6.js","assets/verify-fcd68c05.js","assets/index-95e0417b.js","assets/index-0be103ef.css"]));let n=f({});const r=()=>{z().then(l=>{l.Code>0&&(n.value=l.Data)}),a.value.Email="",a.value.EmailCode="",a.value.Password=""};let c=f(!1);const a=f({Email:"",EmailCode:"",Password:""}),F=async()=>{const l=M("Email",a.value.Email),o=M("Code",a.value.EmailCode);if(l||o){window.$message.warning(l||o);return}c.value=!0;const p=await R({...w(a.value)});c.value=!1,p.Code>0&&r()},B=l=>{A({Title:`邮件已发送至${l}`,Email:l,EmailAction:"设置主要邮箱",IsPassword:!0,async OkBack(o){return a.value.Email=l,a.value.EmailCode=o.Code,a.value.Password=o.Password,W({...w(a.value)}).then(()=>{r()})}})},D=l=>{A({Title:"邮件已发送至主要邮箱",Email:n.value.Email,EmailAction:`删除邮箱${l}`,IsPassword:!0,async OkBack(o){return a.value.Email=l,a.value.EmailCode=o.Code,a.value.Password=o.Password,G({...w(a.value)}).then(()=>{r()})}})};return $(()=>{r()}),(l,o)=>{const p=J,v=j,E=q,u=X,I=Q,S=K;return m(),_(k,null,[e(y(b),null,{default:t(()=>[d("ManageEmail")]),_:1}),i("div",Y,[i("div",Z,[e(p,{round:"",size:70,src:n.value.Avatar},null,8,["src"]),i("div",aa,g(n.value.NickName),1),i("div",ea,g(n.value.Email),1)]),i("div",oa,[(m(!0),_(k,null,O(n.value.UserEmail,(s,T)=>(m(),_("div",{key:T,class:U(["Email_item",{Main:s==n.value.Email}])},[i("div",la,g(s),1),s==n.value.Email?(m(),_("div",sa,"主要")):h("",!0),s!=n.value.Email?(m(),_("div",ta,[e(v,{size:"tiny",type:"error",onClick:V=>D(s)},{default:t(()=>[d(" 删除 ")]),_:2},1032,["onClick"]),e(v,{size:"tiny",type:"primary",onClick:V=>B(s)},{default:t(()=>[d(" 设为主要 ")]),_:2},1032,["onClick"])])):h("",!0)],2))),128)),i("div",na,[e(S,{ref:"loginForm",model:a.value,size:"small",class:"myForm"},{default:t(()=>[e(u,{class:"myForm__item"},{default:t(()=>[e(E,{name:"Email",value:a.value.Email,"onUpdate:value":o[0]||(o[0]=s=>a.value.Email=s),inputProps:{autocomplete:"password"},placeholder:"新增邮箱地址"},{prefix:t(()=>[e(y(N),{name:"MailOutlined"})]),_:1},8,["value"])]),_:1}),e(u,{class:"myForm__item"},{default:t(()=>[e(I,null,{default:t(()=>[e(E,{name:"EmailCode",value:a.value.EmailCode,"onUpdate:value":o[1]||(o[1]=s=>a.value.EmailCode=s),inputProps:{autocomplete:"password"},placeholder:"请输入6位验证码",maxlength:6},null,8,["value"]),e(y(x),{Email:a.value.Email,Action:"新增邮箱"},null,8,["Email"])]),_:1})]),_:1}),e(u,{class:"myForm__item"},{default:t(()=>[e(E,{value:a.value.Password,"onUpdate:value":o[2]||(o[2]=s=>a.value.Password=s),type:"password",name:"Password","show-password-on":"click",placeholder:"请输入密码",inputProps:{autocomplete:"password"}},null,8,["value"])]),_:1}),e(u,{class:"myForm__item"},{default:t(()=>[e(v,{class:"Submit",disabled:c.value,type:"primary",onClick:F},{default:t(()=>[d(" 新增邮箱 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])])])],64)}}});const wa=H(ia,[["__scopeId","data-v-542de214"]]);export{wa as default};
